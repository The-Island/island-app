/*!
 * Island.IO
 * v 0.1
 * Copyright(c) 2012 Sander Pick <sanderpick@gmail.com>
 */// Polyfills
(function(){var a=0,b=["ms","moz","webkit","o"];for(var c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})(),Island=function(a){function h(b,c){g%2==0?a(c).fadeTo(500,.75):a(c).fadeTo(500,1),g+=1}function i(){clearInterval(pulseTimer),clearTimeout(pulseCancel),a("#logo-a").show(),a("#logo-b").hide()}function o(){n.hide().html(k[m]),n.fadeIn("fast"),m++,m==k.length&&(m=0)}function p(b){k=k.concat(b),l++;if(l==j.length){a.fisherYates(k);var c=a.setIntervalObj(this,5e3,o);o()}}function q(b){var c=b?a(".comment-added, .object-added",b):a(".comment-added, .object-added");c.each(function(b){var c=a(this);c.data("ts")||c.data("ts",c.text()),c.text(Util.getRelativeTime(c.data("ts")))})}function s(b,c){x.empty(),a.get("/search/"+encodeURIComponent(b),c)}function t(){a(".is-video").each(function(b){if(a(this).data().timer)return;var c=a(".thumb",this),d=c.length,e=1,f=setInterval(function(){var b=e===0?d-1:e-1;a(c[b]).hide(),a(c[e]).show(),e+=e==d-1?1-d:1},2e3);a(this).data({timer:f})})}function v(b){var c,d,e=20,f=1,g,h,i,j=0,k=[],l=[],m=!0,n=null;return{init:function(){g=a(b);if(g.length===0)return;h=g.offset().top,this.start()},start:function(){i=g.height(),a(g.children()[0]).clone().appendTo(g),l=_.map(g.children(),function(b){return a("img",b).offset().top-h}),c=requestAnimationFrame(_.bind(this.scroll,this))},update:function(){cancelAnimationFrame(c),this.start()},scroll:function(a){var b=this;if(!d||a-d>e){d=Date.now(),j-=f;if(-j>=i){j=0,g.css({marginTop:j});if(k.length!==0){g.empty();for(var h=0;h<k.length;++h)k[h].appendTo(g);this.update()}}else g.css({marginTop:j});var o=n,p=_.find(l,function(a,b){return o=b,-j-a<0});o!==n&&(n=o,m=!0),m&&n!==null&&n!==0&&l[n-1]+(p-l[n-1])/2<-j?(m=!1,cancelAnimationFrame(c),g.animate({marginTop:-p+"px"},200,"easeOutExpo",function(){j=-p,c=requestAnimationFrame(_.bind(b.scroll,b))})):c=requestAnimationFrame(_.bind(b.scroll,b))}else c=requestAnimationFrame(_.bind(b.scroll,b))},receive:function(b){k=[];for(var c=0;c<b.length;c++)k.push(a(b[c]))}}}function A(b){function p(){return Math.min(Math.max(j,(parseInt(c.innerWidth())+h)/(g+h)),k)}var c=a(b),d=50,e=25,f={"482px":1,"231px":"*"},g=231,h=20,i=40,j=2,k=4,l=2,m=0,n=0,o=[];return{collage:function(b,d){if(!x||x.length===0)return;var e=p();for(var f=0;f<e;f++)o[f]=0;b&&C()>x.offset().top&&(d=d||0,o[2]=o[3]=C()-c.offset().top+10+d),a(".each-grid-obj").each(function(b){var c=a(this),d=0,f=0,j=Math.max(Math.round(c.outerWidth()/g),1);for(var k=0;k<e-(j-1);k++)d=o[k]<o[d]?k:d;for(k=0;k<j;k++)f=Math.max(f,o[d+k]);for(k=0;k<j;k++)o[d+k]=parseInt(c.outerHeight())+i+f;c.css("left",d*(g+h)+m).css("top",f+n).show()}),y=Math.max.apply(null,o),c.height(y+100)}}}function B(){z.css({height:a("#search").height()+y})}function C(){var b=a("#recent-comments").length>0?a("#recent-comments"):a(".obj-comments");return b.length>0?b.offset().top+b.height()+20:0}function E(){C()!=D&&w.collage(!0)}function F(){a(this).fadeOut()}var b={green:"#b1dc36",orange:"#d04c38",blue:"#4bb8d7",pink:"#d12b83",lightgreen:"#eff8d7",lightorange:"#f6dbd7",black:"#1a1a1a",darkgray:"#404040",gray:"#808080",lightgray:"#b3b3b3",bordergray:"#cdcdcd",backgray:"#fcfcfb",mattegray:"#f2f2f2"},c={lines:17,length:0,width:3,radius:40,rotate:0,color:"#000",speed:2.2,trail:100,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"},d={lines:13,length:0,width:2,radius:10,rotate:0,color:"#000",speed:2.2,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"},e={lines:17,length:0,width:2,radius:20,rotate:0,color:"#000",speed:2.2,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"auto",left:"auto"},f=function(a){if(a.length===0)return;var b=a.get(0),f;a.hasClass("signin-spinner")?f=c:a.hasClass("search-spinner")?f=d:a.hasClass("upload-spinner")&&(f=e);var g=(new Spinner(f)).spin(b).stop();return{start:function(){g.spin(b)},stop:function(){g.stop()}}},g=0,j=[],k=[],l=0,m=0,n,r=function(b,c,d){!d&&d!==0&&(c<10?d=0:c<30?d=1:c<55?d=2:c<80?d=3:c<105?d=4:d=5),a(b.children()).hide();for(var e=0;e<d;e++)a(b.children()[e]).show();return d},u,w,x,y,z,D;return{go:function(){function i(){if(h.length===0)return;var b=a(this),c=h.width()/h.height();h.width(b.width()),h.height(b.width()/c)}function V(){L.animate({opacity:[0,"easeOutExpo"],left:["+=300","linear"]},200,"easeOutExpo",function(){L.hide(),L.css({opacity:1,left:0}),K.fadeIn("fast"),P.focus()}),M.hide(),N.show()}function W(){K.animate({opacity:[0,"easeOutExpo"],left:["-=300","linear"]},200,function(){K.hide(),K.css({opacity:1,left:0}),L.fadeIn("fast"),S.focus()}),N.hide(),M.show()}function X(){O.removeClass("is-button-alert"),Y()}function Y(){P.removeClass("is-input-alert"),Q.removeClass("is-input-alert")}function Z(){R.removeClass("is-button-alert"),ab()}function ab(){S.removeClass("is-input-alert"),T.removeClass("is-input-alert"),U.removeClass("is-input-alert")}function bb(){a(".signin-strategies").hide(),a(".signin-controls").hide(),a(".signin-forms").hide(),a(".signin-almost-there").hide(),a(".signin-spinner").show()}function cb(){a(".signin-strategies").show(),a(".signin-controls").show(),a(".signin-forms").show(),a(".signin-almost-there").show(),a(".signin-spinner").hide()}function Mb(){kb.show(),jb.removeClass("is-button-alert"),Nb()}function Nb(){Ab.css("color","gray"),Bb.css("color","gray"),Cb.css("color","gray"),Hb.css("color","gray")}function Yb(){Qb.show(),Pb.removeClass("is-button-alert"),Zb()}function Zb(){Vb.css("color","gray"),Wb.css("color","gray"),Ub.css("color","gray")}String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},String.prototype.ltrim=function(){return this.replace(/^\s+/,"")},String.prototype.rtrim=function(){return this.replace(/\s+$/,"")},a.setTimeoutObj=function(a,b,c,d){return setTimeout(function(){c.apply(a,d)},b)},a.setIntervalObj=function(a,b,c,d){return setInterval(function(){c.apply(a,d)},b)},a.fisherYates=function(a){var b=a.length;if(b==0)return!1;while(--b){var c=Math.floor(Math.random()*(b+1)),d=a[b],e=a[c];a[b]=e,a[c]=d}},a.isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},a.put=function(b,c,d){"function"==typeof c&&(d=c,c={}),c._method="PUT",a.post(b,c,d,"json")},a.delete=function(b,c,d){"function"==typeof c&&(d=c,c={}),c._method="DELETE",a.post(b,c,d,"json")},a.fn.serializeObject=function(){var b={},c=this.serializeArray();return a.each(c,function(){b[this.name]?(b[this.name].push||(b[this.name]=[b[this.name]]),b[this.name].push(this.value.trim()||"")):b[this.name]=this.value.trim()||""}),b},a.fn.itemID=function(){try{var b=a(this).attr("id").split("-");return b[b.length-1]}catch(c){return null}},ui.Notification.prototype.fit=function(){var b=(a(window).width()-984)/2-26;return a(".notification").css({minWidth:b,maxWidth:b}),this},u=new v("#trend"),u.init(),a.setIntervalObj(this,5e3,q),q(),w=new A("#grid"),x=a("#grid"),z=a(".grid-wrap");if(x.hasClass("adjustable-grid")){D=C();var c=a(".trending-media-wrap").length>0?a(".trending-media-wrap"):a(".single-left");z.css({top:c.offset().top+c.height()+40}),w.collage(!0)}else w.collage();(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i))&&a("#footer").hide();if(window.location.hash!=="")try{window.history.replaceState("","",window.location.pathname+window.location.search)}catch(d){}a(".jp-jplayer").each(function(b){a("#"+a(this).attr("id")).jPlayer({ready:function(b){a(this).jPlayer("setMedia",{mp3:a(this).data("src")})},play:function(){a(this).jPlayer("pauseOthers")},swfPath:"https://d271mvlc6gc7bl.cloudfront.net/main/jplayer/js",wmode:"window",cssSelectorAncestor:"#jp_container_"+(b+1)})}),a("video").each(function(){jwplayer(a(this).attr("id")).setup({flashplayer:"https://d271mvlc6gc7bl.cloudfront.net/main/jwplayer/player.swf",skin:"https://d271mvlc6gc7bl.cloudfront.net/main/jwplayer/skins/bekle.zip"})}),t(),twitterNames=a("#twitter-names").text().split(",");for(var e=0;e<twitterNames.length;e++)twitterNames[e]!="undefined"&&twitterNames[e]!=""&&j.push(twitterNames[e]);n=a("#twitter");for(var g in j)a.tweet({username:j[g],callback:p});var h=a(".signin-bg > img");h.length>0&&(a(window).resize(i),i());var k=new f(a(".signin-spinner")),l=new f(a(".search-spinner")),m=new f(a(".upload-spinner")),o=Util.getQueryVariable("p"),y=o&&o!==""?Number(o):1;if(a("#grid").length!==0){var F=a(document),G=a(window),H=!1,I=!1,J=_.throttle(function(b){var c=F.height()-G.height()-F.scrollTop();!H&&!I&&c<100&&!x.hasClass("search-results")&&(H=!0,a.post("/page/"+(y+1),function(b){if("success"===b.status){if(b.data.results.length===0){I=!0;return}++y;for(var c=0;c<b.data.results.length;++c)a(b.data.results[c]).appendTo(x);x.hasClass("adjustable-grid")?w.collage(!0):w.collage(),q(comHolder),t()}else console.log(b.message);H=!1},"json"))},100);G.scroll(J).resize(J)}a('form input[type="text"], form input[type="password"], form textarea').bind("focus",function(){a(this).hasClass("is-input-alert")&&a(this).removeClass("is-input-alert")});var K=a("#login-form"),L=a("#register-form"),M=a("#goto-login-form"),N=a("#goto-register-form"),O=a("#login"),P=a('input[name="username"]'),Q=a('input[name="password"]'),R=a("#add-member"),S=a('input[name="newname"]'),T=a('input[name="newusername"]'),U=a('input[name="newpassword"]');a("a",N).bind("click",function(){W()}),a("a",M).bind("click",function(){V()}),P.focus(),O.bind("mouseenter",function(){var a=P.val().trim(),b=Q.val().trim();a!==""&&b!==""?Y():(O.addClass("is-button-alert"),a==""&&P.addClass("is-input-alert"),b==""&&Q.addClass("is-input-alert"))}).bind("mouseleave",X),O.bind("click",function(b){b.preventDefault(),k.start(),bb();var c=K.serializeObject();a.post("/login",c,function(b){if("success"===b.status)window.location=b.data.path;else if("fail"===b.status){cb(),k.stop(),ui.error(b.data.message).closable().hide(8e4).effect("fade").fit();switch(b.data.code){case"MISSING_FIELD":case"ACCOUNT_WAITING":var c=b.data.missing;for(var d=0;d<c.length;++d)a('input[name="'+c[d]+'"]').addClass("is-input-alert").val("");break;case"BAD_AUTH":Q.val("").focus();break;case"NOT_CONFIRMED":}}},"json")}),R.bind("mouseenter",function(){var a=S.val().trim(),b=T.val().trim(),c=U.val().trim();a!=""&&b!=""&&c!=""?ab():(R.addClass("is-button-alert"),a==""&&S.addClass("is-input-alert"),b==""&&T.addClass("is-input-alert"),c==""&&U.addClass("is-input-alert"))}).bind("mouseleave",Z),R.bind("click",function(b){b.preventDefault(),k.start(),bb();var c=L.serializeObject();c.id=R.data("id"),a.put("/signup",c,function(b){if("success"===b.status)window.location=b.data.path;else if("fail"===b.status){cb(),k.stop(),ui.error(b.data.message).closable().hide(8e3).effect("fade").fit();switch(b.data.code){case"MISSING_FIELD":var c=b.data.missing;for(var d=0;d<c.length;++d)a('input[name="'+c[d]+'"]').addClass("is-input-alert");break;case"INVALID_EMAIL":case"DUPLICATE_EMAIL":T.val("").addClass("is-input-alert"),T.focus()}}})}),a(".from-login").click(function(a){k.start(),bb()}),a(".from-settings").click(function(b){a(".signin-strategy-btn, .signin-strategy-btn-disabled").hide(),k.start(),a(".signin-spinner").show()}),a(".resend-conf").live("click",function(b){var c=a(this).itemID();a.post("/resendconf/"+c,{id:c},function(a){if("success"===a.status)return ui.notify(a.data.message).closable().hide(8e3).effect("fade").fit();"error"===a.status&&ui.error(a.data.message).closable().hide(8e3).effect("fade").fit()},"json")});var db=a("#logo-a"),eb=a("#logo-b"),fb=[db,eb];a("textarea").autogrow();var gb=a("#search-box");navigator.userAgent.indexOf("Firefox")!==-1&&gb.css({padding:"5px 10px"}),gb.bind("keyup search",function(b){l.start();var c=a(this).val().trim().toLowerCase();x.empty(),""===c&&(c="__clear__"),s(c,function(b){if("success"===b.status){for(var d=0;d<b.data.results.length;d++)a(b.data.results[d]).appendTo(x);x.hasClass("adjustable-grid")?w.collage(!0):w.collage(),q(x),t(),"__clear__"===c?(x.removeClass("search-results"),y=1):x.addClass("search-results")}else console.log(b.message);l.stop()})}).bind("focus",B),x.addClass("search-results"),gb.trigger("keyup"),a(".grid-obj, .trending, .object-title-parent").live("click",function(b){b.preventDefault();var c=a(this).data();a.put("/hit/"+c.id,function(a){if("error"===a.status)return console.log(a.message);window.location="/"+c.key})}),a(".commentor-input-dummy").bind("focus",function(){a(this).hide(),a(this.nextElementSibling).show(),a(this.nextElementSibling.firstElementChild).focus(),E()}),a(".commentor-input").bind("blur",function(){this.value.trim()==""&&(a(this.parentNode).hide(),a(this).val("").css({height:32}),a(this.parentNode.previousElementSibling).show(),E())}).bind("keyup",E),a(".add-comment").bind("click",function(){var b=a(this.previousElementSibling).val();b=b.replace(/\<script\>/ig,""),b=b.replace(/\<\/script\>/ig,""),b=a("<div>").html(b).text().trim();if(b==="")return!1;a(this.previousElementSibling).val("").css({height:32}),a(this.parentNode).hide(),a(this.parentNode.previousElementSibling).show();var c=a(this).itemID();a.put("/comment/"+c,{body:b},function(a){if("error"===a.status)return console.log(a.message);"fail"===a.status&&ui.error(a.data.message).closable().hide(12e3).effect("fade").fit()})}),a(".delete-comment").live("click",function(b){var c=a(this),d=c.itemID();a.delete("/comment/"+d,function(a){if("fail"===a.status)return ui.error(a.data.message).closable().hide(8e3).effect("fade").fit();if("error"===a.status)return console.log(a.message)})}),a(".obj-holder").bind("mouseenter",function(){a(".hearts",this).show()}).bind("mouseleave",function(){a(".hearts",this).hide()});var hb=a("#recent-comments").length>0?a("#recent-comments"):a(".obj-comments");hb.length>0&&a.get("/comments/"+hb.data("id")+"/"+hb.data("limit"),{showMember:hb.data("showmember")},function(b){if("success"===b.status){for(var c=0;c<b.data.results.length;c++)a(b.data.results[c]).appendTo(hb);q(hb)}else console.log(b.message)}),a(".hearts-wrap img, .hearts-back img").bind("mousedown",function(a){a.preventDefault()}),a(".hearts").each(function(){var b=a(this),c=parseInt(b.data("num")),d=0,e=0,f=a(".hearts-back",this),g=a(".hearts-wrap",this);c>0&&r(g,null,c),f.bind("mouseleave",function(a){r(g,null,c)}).bind("mousemove",function(a){d=a.pageX-f.offset().left,e=r(g,d)}).bind("click",function(b){c=e;var d=f.itemID();a.put("/rate/"+d,{val:e},function(a){if("error"===a.status)return console.log(a.message)})})}),a(".obj-details[data-date]").each(function(){var b=a(this),c=new Date(b.data("date")),d;switch(b.data("type")){case"media":d="Added "+Util.toLocaleString(c,"mmm d, yyyy");break;case"profile":switch(b.data("role")){case 0:d="Contributor since "+Util.toLocaleString(c,"m/d/yy");break;case 1:d="Member since "+Util.toLocaleString(c,"m/d/yy")}}b.data("location")&&(d+=" At "+b.data("location")),b.text(d)}),a(".birthday").each(function(){var b=a(this);b.text(Util.getAge(b.text()))});var ib=a("#settings-form"),jb=a("#save-settings"),kb=a("#save-settings-mask"),lb=a('input[name="member[displayName]"]'),mb=a('input[name="member[username]"]'),nb=a('input[name="member[primaryEmail]"]'),ob=a("img.settings-banner"),pb=a('input[name="my_banner"]'),qb=a('input[name="member[assembly]"]'),rb=a('input[name="member[bannerLeft]"]'),sb=a('input[name="member[bannerTop]"]'),tb=a('input[name="member[description]"]'),ub=a('input[name="member[location]"]'),vb=a('input[name="member[hometown]"]'),wb=a('input[name="member[birthday]"]'),xb=a('input[name="member[gender]"]'),yb=a('input[name="member[website]"]'),zb=a('input[name="member[twitter]"]'),Ab=a('label[for="member[displayName]"]'),Bb=a('label[for="member[username]"]'),Cb=a('label[for="member[primaryEmail]"]'),Db=a('label[for="my_banner"]'),Eb=a('label[for="member[description]"]'),Fb=a('label[for="member[location]"]'),Gb=a('label[for="member[hometown]"]'),Hb=a('label[for="member[birthday]"]'),Ib=a('label[for="member[gender]"]'),Jb=a('label[for="member[website]"]'),Kb=a('label[for="member[twitter]"]'),Lb=!1;kb.each(function(a){var b=jb.outerWidth(),c=jb.outerHeight();kb.css({width:b,height:c})}),kb.bind("mouseenter",function(){var a=lb.val().trim(),c=mb.val().trim(),d=nb.val().trim();a!==""&&c!==""&&d!==""&&!Lb?(kb.css("bottom",1e4).hide(),Nb()):(jb.addClass("is-button-alert"),a===""&&Ab.css("color",b.orange),c===""&&Bb.css("color",b.orange),d===""&&Cb.css("color",b.orange))}).bind("mouseleave",Mb),jb.bind("mouseleave",function(){kb.css("bottom",0),Mb()}),jb.bind("click",function(c){c.preventDefault();if(Lb)return;var d=ib.serializeObject();return delete d.params,a.put("/save/settings",d,function(a){if("success"===a.status)return ui.notify("Edits saved.").closable().hide(8e3).effect("fade").fit();if("error"===a.status&&a.data.inUse)switch(a.data.inUse){case"primaryEmail":ui.error("Email address is already in use.").closable().hide(8e3).effect("fade").fit(),nb.focus(),Cb.css("color",b.orange);break;case"username":ui.error("Username is already in use.").closable().hide(8e3).effect("fade").fit(),mb.focus(),Bb.css("color",b.orange)}else if("error"===a.status&&a.data.invalid)switch(a.data.invalid){case"birthday":ui.error("Birthday not a valid date.").closable().hide(8e3).effect("fade").fit(),wb.val("").focus(),Hb.css("color",b.orange)}}),!1}),ib.transloadit({wait:!0,autoSubmit:!1,modal:!1,processZeroFiles:!1,onSuccess:function(b){m.stop(),ob.show();if(b.ok!=="ASSEMBLY_COMPLETED")return ui.error("Upload failed. Please try again.").closable().hide(8e3).effect("fade").fit();if(a.isEmpty(b.results)&&Lb)return ui.error("You must choose a file.").closable().hide(8e3).effect("fade").fit();if(Lb){var c=b.results.image_thumb[0],d=232,e=104,f,g,h;f=d,g=c.meta.height/c.meta.width*d,g-e>=0?h="top:"+ -(g-e)/2+"px;":(f=c.meta.width/c.meta.height*e,g=e,h="left:"+ -(f-d)/2+"px;"),ob.attr({src:c.url,width:f,height:g,style:h}),qb.val(JSON.stringify(b)),Lb=!1;return}}}),pb.bind("change",function(){Lb=!0,ob.hide(),m.start(),ib.submit()}),ob.bind("mousedown",function(a){a.preventDefault();var b={x:ob.width(),y:ob.height()},c={x:a.pageX,y:a.pageY},d={x:parseInt(ob.css("left")),y:parseInt(ob.css("top"))},e=function(a){var e={x:a.pageX-c.x,y:a.pageY-c.y},f=e.y+d.y,g=e.x+d.x;f<=0&&b.y+f>=104&&(sb.val(f),ob.css({top:f+"px"})),g<=0&&b.x+g>=232&&(rb.val(g),ob.css({left:g+"px"}))};ob.bind("mousemove",e),ob.bind("mouseup",function(a){ob.unbind("mousemove",e),ob.unbind("mouseup",arguments.callee)})});var Ob=a("#media-form"),Pb=a("#add-media"),Qb=a("#add-media-mask"),Rb=a('input[name="post[title]"]'),Sb=a('textarea[name="post[body]"]'),Tb=a('input[name="post[meta.tags]"]'),Ub=a('input[name="my_file"]'),Vb=a('label[for="post[title]"]'),Wb=a('label[for="post[body]"]'),Xb=a('label[for="post[meta.tags]"]');Qb.each(function(a){var b=Pb.outerWidth(),c=Pb.outerHeight();Qb.css({width:b,height:c})}),Qb.bind("mouseenter",function(){var a=Rb.val().trim(),c=Sb.val().trim(),d=Ub.val();a!==""&&c!==""&&d!==""?(Qb.css("bottom",1e4).hide(),Zb()):(Pb.addClass("is-button-alert"),a===""&&Vb.css("color",b.orange),c===""&&Wb.css("color",b.orange),d===""&&Ub.css("color",b.orange))}).bind("mouseleave",Yb),Pb.bind("mouseleave",function(){Qb.css("bottom",0),Yb()}),Ob.transloadit({wait:!0,autoSubmit:!1,onSuccess:function(b){if(b.ok!=="ASSEMBLY_COMPLETED")return ui.error("Upload failed. Please try again.").closable().hide(8e3).effect("fade").fit();if(a.isEmpty(b.results))return ui.error("You must choose a file.").closable().hide(8e3).effect("fade").fit();var c=Rb.val();c=c.replace(/\<script\>/ig,""),c=c.replace(/\<\/script\>/ig,""),c=a("<p>").html(c).text().trim(),Rb.val(c);var d=Sb.val();d=d.replace(/\<script\>/ig,""),d=d.replace(/\<\/script\>/ig,""),d=a("<p>").html(d).text().trim(),Sb.val(d);var e=Ob.serializeObject();delete e.params,e.assembly=b,a.put("/insert",e,function(b){if("error"===b.status)return console.log(b.message);Rb.val(""),Sb.val(""),Tb.val(""),Ub=a('input[name="my_file"]')})}}),a("#delete-post").click(function(b){var c=a(this).data("key");(new ui.Confirmation({title:"Reeeaaally?",message:"Your post will be removed, forever."})).modal().show(function(b){b&&a.delete("/post/"+c,function(a){if("fail"===a.status)return ui.error(a.data.message).closable().hide(8e3).effect("fade").fit();if("error"===a.status)return console.log(a.message);ui.dialog("I crushed it! - Love, ISLAND").modal().show(),_.delay(function(){window.location="/"},2e3)})}).ok("Delete")}),a("#delete-profile").click(function(b){(new ui.Confirmation({title:"Reeeaaally?",message:a('<p>Your data will be removed, forever.</p><input class="password-for-delete" type="password" name="password" placeholder="Your password, please ..." />')})).modal().show(function(b){if(b){var c=a(".password-for-delete").val().trim();a.delete("/member",{password:c},function(a){if("fail"===a.status)return ui.error(a.data.message).closable().hide(8e3).effect("fade").fit();if("error"===a.status)return console.log(a.message);ui.dialog("Hasta la pasta! - Love, ISLAND").modal().show(),_.delay(function(){window.location="/login"},2e3)})}}).ok("Delete")})},receiveMedia:function(b){var c=a(b);c.prependTo(x).css({opacity:0}),x.hasClass("adjustable-grid")?w.collage(!0):w.collage(),c.animate({opacity:1},500),q(x),t()},receiveComment:function(b,c){var d=a(b),e=a("#coms-"+c),f=a("#recent-comments");f.length>0?(a(f.children()[f.children().length-1]).remove(),f.hasClass("no-member")&&a(".comment-title-name",d).remove(),d.hide().css({opacity:0}).appendTo(f),w.collage(!0,d.height()),q(e),setTimeout(function(){d.prependTo(f).show(250).animate({opacity:1},500)},100)):e.length>0&&(d.hide().css({opacity:0}).prependTo(e),a("a.comment-title-parent",d).remove(),w.collage(!0,d.height()),q(e),setTimeout(function(){d.show(250).animate({opacity:1},500)},100))},receiveUpdate:function(b,c,d){_.each(b,function(b){var e=a("#"+b);if(e.length>0){var f=a(".meta-"+c+"s",e);f.text(Util.addCommas(d)+" x ")}})},receiveTrends:function(a,b){if(a)return console.log(a);u.receive(b)},notifyComment:function(a){now.renderComment(a)},deleteComment:function(b){var c=a("#com-"+b);c.fadeOut("fast",function(){c.remove()})}}}(jQuery),now.ready(function(){now.receiveMedia=Island.receiveMedia,now.receiveComment=Island.receiveComment,now.receiveUpdate=Island.receiveUpdate,now.receiveTrends=Island.receiveTrends,now.deleteComment=Island.deleteComment,now.notifyComment=Island.notifyComment});