<%
  var gravatar = 'https://www.gravatar.com/avatar/'
      + this.model.get('author').gravatar + '?s=48&d='
      + encodeURIComponent(this.app.images.avatar);

  var weather = this.model.get('weather');
%>

<% if (!this.parentView) { %>
  <div class="leftside">
<% } %>

<% if (this.parentView) { %>
  <div class="mini-map" id="crag_map_<%= this.model.id %>"></div>
  <div class="event-title">
    <a href="/<%= this.model.get('author').username %>" class="title navigate">
      <%= this.model.formatAuthorFor(this.app.profile.member) %></a> logged 
      <a href="/sessions/<%= this.model.get('key') %>" class="title navigate">climbing</a>.
    <a href="/crags/<%= this.model.get('crag').key %>" class="session-location title navigate">
      <i class="icon-location"></i> <%= this.model.get('crag').name %>, <%= this.model.get('crag').country %>
    </a>
  </div>
  <span class="event-title-text">
    
    <% if (weather) { %>
      <span class="session-weather">
        <%= this.model.tempRange() %>&degC <%= this.model.formatWeatherIconName() %>,
        <%= this.model.weatherDetail() %>
      </span>
    <% } %>
  </span>
<% } %>
<% if (this.model.get('actions').length === 0) { %>
  <span class="session-empty">No activities</span>
<% } %>
<% _.each(this.model.get('actions'), _.bind(function (a) { %>
  <% if (a.ticks.length > 0) { %>
    <%= this.renderActivity(a) %>
  <% } %>
<% }, this)); %>

<% if (!this.parentView) { %>
  </div>
  <div class="rightside">
    <div class="mini-map" id="session_map_<%= this.model.id %>"></div>
  </div>
  <div class="clear"></div>
<% } %>
